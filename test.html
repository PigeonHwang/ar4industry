<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>QR 코드 인식</title>
    <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
    <style>
        #myDiv {
            display: none;
            transition: opacity 2s ease-out;
        }
        .visible {
            display: block;
            opacity: 1;
        }
        .hidden {
            opacity: 0;
        }
        #camera-feed {
            width: 300px;
            height: 300px;
            border: 2px solid black;
        }
    </style>
</head>
<body>

<div id="myDiv" class="hidden">QR 코드가 인식되었습니다!</div>
<div id="qr-reader" style="width:300px;"></div>
<video id="camera-feed" autoplay></video>

<script>
    function handleQRCodeScanned(decodedText, decodedResult) {
        const targetQRCode = "example-qr-code"; 
        const div = document.getElementById('myDiv');
        
        if (decodedText === targetQRCode) {
            div.classList.remove('hidden');
            div.classList.add('visible');
        } else {
            div.classList.remove('visible');
            div.classList.add('hidden');
        }
    }

    function handleQRCodeScanError(errorMessage) {
        console.warn(errorMessage);
    }

    function startCamera() {
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => {
                const video = document.getElementById('camera-feed');
                video.srcObject = stream;
            })
            .catch(err => console.error("카메라 접근 오류:", err));
    }

    const html5QrCode = new Html5Qrcode("qr-reader");
    html5QrCode.start(
        { facingMode: "environment" }, 
        {
            fps: 10,
            qrbox: 250
        },
        handleQRCodeScanned,
        handleQRCodeScanError
    );

    window.onload = startCamera;

</script>

</body>
